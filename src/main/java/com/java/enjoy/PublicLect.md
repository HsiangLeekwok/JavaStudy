##秒杀核心业务分析

秒杀业务分析

商品查询  ->  创建订单  ->  订单支付  ->  卖家发货
   _____________|__________________________
   |             |            |            |
加入购物车  ->  确定订单  ->  修改库存  ->  待支付

秒杀技术分析

## 关于锁的那些事

#### 悲观锁解析

    概述：悲观锁对数据被外界的修改持保守态度（悲观），因此在整个数据处理过程中数据处于锁定状态，往往依靠数据库提供的锁机制实现
    使用场景：写多读少，保证数据安全
    样例：行锁、页锁、表锁、共享锁(读锁)、排他锁(写锁)

#### 乐观锁解析

    概述：乐观锁假设认为数据一般情况下不会造成冲突，所以在数据进行提交更新的时候，才会正式对数据的冲突与否进行检测，如果发现冲突了，则让返回用户错误的信息，让用户决定如何去做或者程序自动去重试
    使用场景：读多写少，提高系统吞吐量
    样例：数据库乐观锁、缓存乐观锁
    
## 秒杀核心服务实战

三套解决方案

    1、基于mySql通过版本号实现
    2、基于mysql通过状态实现
        缺点：简单高效
    3、基于memcached的cas机制实现
        1、读取数据
        2、比较版本
        3、更新数据
        
        方法：
            1、基于redis的实现：利用watch指令在redis事物中提供CAS的能力
            2、基于memcached的实现：1.2.4版本新增特性，通过gets和cas实现

手把手实现核心业务